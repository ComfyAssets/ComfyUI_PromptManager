<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
    <title>PromptManager â€” Metadata Extractor</title>
    <link rel="stylesheet" href="/prompt_manager/css/style.css" />
    <link rel="stylesheet" href="/prompt_manager/css/blue-theme-update.css" />
    <link rel="stylesheet" href="/prompt_manager/css/components.css" />
    <link rel="stylesheet" href="/prompt_manager/css/metadata.css" />
    <link rel="stylesheet" href="/prompt_manager/css/notifications.css" />
    <link rel="stylesheet" href="/prompt_manager/css/migration.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
      integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <!-- ViewerJS CSS -->
    <link rel="stylesheet" href="/prompt_manager/vendor/viewerjs/dist/viewer.min.css" />

</head>
  <body x-data="pmMetaApp()" x-init="init()">
    <div class="app-container">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <div id="brand-badge" class="brand-badge">PM</div>
          <div>
            <div class="sidebar-header-title">PromptManager</div>
            <div class="sidebar-header-subtitle">
              Professional Suite
            </div>
          </div>
        </div>

                                                <nav class="nav-menu">
          <a href="/prompt_manager/" class="nav-item">
            <i class="fa-solid fa-house nav-icon" aria-hidden="true"></i>
            <span>Home</span>
          </a>
          <a href="/prompt_manager/dashboard" class="nav-item">
            <i class="fa-solid fa-chart-line nav-icon" aria-hidden="true"></i>
            <span>Dashboard</span>
          </a>
          <a href="/prompt_manager/gallery" class="nav-item">
            <i class="fa-solid fa-images nav-icon" aria-hidden="true"></i>
            <span>Gallery</span>
          </a>
          <a href="/prompt_manager/collections" class="nav-item">
            <i class="fa-solid fa-folder-tree nav-icon" aria-hidden="true"></i>
            <span>Collections</span>
          </a>
          <a href="/prompt_manager/stats" class="nav-item">
            <i class="fa-solid fa-chart-column nav-icon" aria-hidden="true"></i>
            <span>Stats</span>
          </a>
          <a href="/prompt_manager/metadata" class="nav-item active">
            <i class="fa-solid fa-tags nav-icon" aria-hidden="true"></i>
            <span>Metadata</span>
          </a>
          <a href="/prompt_manager/settings" class="nav-item">
            <i class="fa-solid fa-gear nav-icon" aria-hidden="true"></i>
            <span>Settings</span>
          </a>
          <a href="/prompt_manager/logs" class="nav-item">
            <i class="fa-solid fa-clipboard-list nav-icon" aria-hidden="true"></i>
            <span>Logs</span>
          </a>
        </nav>
      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Topbar -->
        <div class="topbar">
          <div class="search-container">
            <input
              type="text"
              placeholder="Search metadata..."
              class="search-input"
            />
          </div>
          <div class="topbar-actions">
            <button class="btn btn-ghost">
              <span><i class="fa-regular fa-bell" aria-hidden="true"></i></span>
            </button>
            <button class="btn btn-ghost">
              <span><i class="fa-solid fa-gear" aria-hidden="true"></i></span>
            </button>
          </div>
        </div>

        <!-- Page Content -->
        <div class="page-content">
          <div class="page-header">
            <div>
              <h1>Metadata Extractor</h1>
              <p>Extract ComfyUI workflow data from PNG images</p>
            </div>
          </div>

          <!-- Drop Zone -->
          <section :class="['drop-zone', drag ? 'drag' : '', thumb ? 'small' : 'large']" @dragover.prevent="drag=true" @dragleave="drag=false" @drop.prevent="handleDrop($event)">
            <div class="drop-zone-content">
              <div class="drop-zone-icon">ðŸ“Ž</div>
              <div class="drop-zone-text">
                Drag & drop image (PNG/JPEG/WEBP) or
              </div>
              <input id="pick" type="file" accept="image/*" class="file-input-hidden" @change="filePicked" />
              <button class="btn btn-primary" @click="document.getElementById('pick').click()">
                Choose File
              </button>
            </div>
          </section>

          <!-- Image and Prompts -->
          <template x-if="thumb">
            <div class="metadata-grid">
              <div class="card">
                <h3 class="card-title">Image Preview</h3>
                <img class="preview" :src="thumb" alt="preview" />
                <div class="file-info">
                  <span x-text="fileName"></span> â€¢
                  <span x-text="fileType"></span> â€¢
                  <span x-text="(fileSize/1024).toFixed(1) + ' KB'"></span>
                </div>
              </div>

              <div class="card">
                <div class="section-header">
                  <h3 class="section-title">Extracted Prompts</h3>
                  <div class="btn-actions">
                    <button class="btn btn-secondary btn-sm" @click="copy(texts.positive)">
                      Copy Positive
                    </button>
                    <button class="btn btn-secondary btn-sm" @click="copy(texts.negative)">
                      Copy Negative
                    </button>
                  </div>
                </div>

                <div class="prompt-section">
                  <div class="prompt-indicator">
                    <div class="indicator-dot-brand"></div>
                    <strong>Positive Prompt</strong>
                  </div>
                  <pre x-text="texts.positive || '(none found)'"></pre>
                </div>

                <div>
                  <div class="prompt-indicator">
                    <div class="indicator-dot-pink"></div>
                    <strong>Negative Prompt</strong>
                  </div>
                  <pre x-text="texts.negative || '(none found or not used by this model)'"></pre>
                </div>
              </div>
            </div>
          </template>

          <!-- Workflow and Raw Data -->
          <template x-if="workflow || raw">
            <div class="metadata-grid">
              <div class="card">
                <div class="section-header">
                  <h3 class="section-title">Workflow Data</h3>
                  <button class="btn btn-secondary btn-sm" @click="copy(workflow)">
                    Copy JSON
                  </button>
                </div>
                <pre x-text="workflow || '(none found)'"></pre>
              </div>

              <div class="card">
                <div class="section-header">
                  <h3 class="section-title">Raw Metadata</h3>
                  <button class="btn btn-secondary btn-sm" @click="downloadRaw">
                    Download JSON
                  </button>
                </div>
                <pre x-text="raw"></pre>
              </div>
            </div>
          </template>

          <!-- Empty State -->
          <div x-show="!thumb && !workflow && !raw" class="empty-state-metadata">
            <div class="empty-state-icon-large"><i class="fa-solid fa-tags" aria-hidden="true"></i></div>
            <h3 class="empty-state-title">No Image Selected</h3>
            <p class="empty-state-text">Upload an image to extract its metadata and workflow information</p>
          </div>
        </div>
      </main>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/exif-js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pako@2/dist/pako.min.js"></script>
    <script>
      (function(){
        const $ = (s, r=document) => r.querySelector(s);
        async function parsePngText(arrayBuffer){
          const data=new DataView(arrayBuffer); const text={}; let pos=8;
          while(pos<data.byteLength){ const len=data.getUint32(pos); pos+=4; const type=String.fromCharCode(data.getUint8(pos),data.getUint8(pos+1),data.getUint8(pos+2),data.getUint8(pos+3)); pos+=4; const chunk=new Uint8Array(arrayBuffer,pos,len); pos+=len; pos+=4; if(type==='tEXt'){ const idx=chunk.indexOf(0); const key=new TextDecoder().decode(chunk.slice(0,idx)); const val=new TextDecoder().decode(chunk.slice(idx+1)); text[key]=val; } else if(type==='iTXt'){ let i=0; const readz=()=>{ const j=chunk.indexOf(0,i); const s=new TextDecoder().decode(chunk.slice(i,j)); i=j+1; return s; }; const keyword=readz(); const compFlag=chunk[i++]; const compMethod=chunk[i++]; readz(); readz(); const textBytes=chunk.slice(i); let val; if(compFlag===1){ try{ val=new TextDecoder().decode(pako.inflate(textBytes)); }catch{ val=''; } } else { val=new TextDecoder().decode(textBytes);} text[keyword]=val; } else if(type==='zTXt'){ let i=0; const j=chunk.indexOf(0,i); const keyword=new TextDecoder().decode(chunk.slice(0,j)); i=j+1; i++; const val=new TextDecoder().decode(pako.inflate(chunk.slice(i))); text[keyword]=val; } }
          return text;
        }
        function parsePossibleParams(str){ const out={positive:'',negative:''}; if(!str) return out; const negIdx=str.toLowerCase().indexOf('negative prompt'); if(negIdx>=0){ out.positive=str.slice(0,negIdx).trim().replace(/^prompt[: ]*/i,'').trim(); out.negative=str.slice(negIdx).replace(/negative prompt[: ]*/i,'').split('\n')[0].trim(); } else { out.positive=str.trim(); } return out; }
        window.pmMetaApp=function(){ return { drag:false, thumb:'', fileName:'', fileSize:0, fileType:'', texts:{positive:'',negative:''}, workflow:'', raw:'', init(){}, async handleDrop(e){ this.drag=false; const f=e.dataTransfer.files?.[0]; if(!f) return; await this.processFile(f); }, async filePicked(e){ const f=e.target.files?.[0]; if(!f) return; await this.processFile(f); e.target.value=''; }, async processFile(file){ this.fileName=file.name; this.fileSize=file.size; this.fileType=file.type; this.thumb=URL.createObjectURL(file); const buf=await file.arrayBuffer(); this.texts={positive:'',negative:''}; this.workflow=''; this.raw=''; if(file.type==='image/png'){ const t=await parsePngText(buf); this.raw=JSON.stringify(t,null,2); const params=t.parameters||t.Parameter||t.parametersTxt||''; const prompt=t.prompt||t.Prompt||''; const neg=t['negative_prompt']||t.Negative||''; const wflow=t.workflow||t.Workflow||t['sd-metadata']||''; if(wflow){ try{ this.workflow=JSON.stringify(JSON.parse(wflow),null,2);}catch{ this.workflow=String(wflow);} } if(params){ const p=parsePossibleParams(params); this.texts.positive=p.positive||prompt||''; this.texts.negative=p.negative||neg||''; } else { this.texts.positive=prompt||''; this.texts.negative=neg||''; } } else if(file.type==='image/jpeg' || file.type==='image/jpg'){ EXIF.getData(file, ()=>{ const all=EXIF.getAllTags(this)||{}; this.raw=JSON.stringify(all,null,2); const user=all.UserComment||all.ImageDescription||''; const p=parsePossibleParams(String(user)); this.texts.positive=p.positive; this.texts.negative=p.negative; }); } else { this.raw='(unknown image format for metadata)'; } }, copy(txt){ navigator.clipboard.writeText(txt||''); if (window.showToast) { window.showToast('Copied!', 'success'); } else if (window.notificationService) { window.notificationService.success('Copied!'); } else { console.log('[success] Copied!'); } }, downloadRaw(){ const blob=new Blob([this.raw||'{}'],{type:'application/json'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='metadata.json'; a.click(); URL.revokeObjectURL(url); }, }; }
      })();
    </script>
    <script>
      // Extend/override pmMetaApp with gallery support and robust buffer handling
      (function(){
        function detectType(buf){ const b=new Uint8Array(buf); const isPNG = b[0]===0x89 && b[1]===0x50 && b[2]===0x4E && b[3]===0x47 && b[4]===0x0D && b[5]===0x0A && b[6]===0x1A && b[7]===0x0A; const isJPG = b[0]===0xFF && b[1]===0xD8; return isPNG ? 'image/png' : (isJPG ? 'image/jpeg' : 'application/octet-stream'); }
        const original = window.pmMetaApp;
        window.pmMetaApp = function(){
          const base = original ? original() : {};
          return Object.assign(base, {
            gallery: [],
            async processBuffer(buf, name, type){
              this.texts={positive:'',negative:''}; this.workflow=''; this.raw='';
              if(!type||type==='application/octet-stream') type = detectType(buf);
              if(type==='image/png'){
                const t = await (async function parsePngText(arrayBuffer){
                  const data=new DataView(arrayBuffer); const text={}; let pos=8;
                  while(pos<data.byteLength){ const len=data.getUint32(pos); pos+=4; const typeStr=String.fromCharCode(data.getUint8(pos),data.getUint8(pos+1),data.getUint8(pos+2),data.getUint8(pos+3)); pos+=4; const chunk=new Uint8Array(arrayBuffer,pos,len); pos+=len; pos+=4; if(typeStr==='tEXt'){ const idx=chunk.indexOf(0); const key=new TextDecoder().decode(chunk.slice(0,idx)); const val=new TextDecoder().decode(chunk.slice(idx+1)); text[key]=val; } else if(typeStr==='iTXt'){ let i=0; const readz=()=>{ const j=chunk.indexOf(0,i); const s=new TextDecoder().decode(chunk.slice(i,j)); i=j+1; return s; }; const keyword=readz(); const compFlag=chunk[i++]; const compMethod=chunk[i++]; readz(); readz(); const textBytes=chunk.slice(i); let val; if(compFlag===1){ try{ val=new TextDecoder().decode(pako.inflate(textBytes)); }catch{ val=''; } } else { val=new TextDecoder().decode(textBytes);} text[keyword]=val; } else if(typeStr==='zTXt'){ let i=0; const j=chunk.indexOf(0,i); const keyword=new TextDecoder().decode(chunk.slice(0,j)); i=j+1; i++; const val=new TextDecoder().decode(pako.inflate(chunk.slice(i))); text[keyword]=val; } }
                  return text;
                })(buf);
                this.raw=JSON.stringify(t,null,2);
                const params=t.parameters||t.Parameter||t.parametersTxt||'';
                const prompt=t.prompt||t.Prompt||''; const neg=t['negative_prompt']||t.Negative||'';
                const wflow=t.workflow||t.Workflow||t['sd-metadata']||'';
                if(wflow){ try{ this.workflow=JSON.stringify(JSON.parse(wflow),null,2);}catch{ this.workflow=String(wflow);} }
                if(params){ const split = (function(str){ const out={positive:'',negative:''}; const idx=str.toLowerCase().indexOf('negative prompt'); if(idx>=0){ out.positive=str.slice(0,idx).trim().replace(/^prompt[: ]*/i,'').trim(); out.negative=str.slice(idx).replace(/negative prompt[: ]*/i,'').split('\n')[0].trim(); } else { out.positive=str.trim(); } return out; })(params); this.texts.positive=split.positive||prompt||''; this.texts.negative=split.negative||neg||''; } else { this.texts.positive=prompt||''; this.texts.negative=neg||''; }
              } else if(type==='image/jpeg'){
                this.raw = `(JPEG) ${name} â€” ${Math.round(buf.byteLength/1024)} KB`;
              } else {
                this.raw='(unknown image format for metadata)';
              }
              this.fileName=name; this.fileType=type; this.fileSize=buf.byteLength;
              return true;
            },
            async openGallery(){ try{ await this.loadGallery(); } finally { const d=document.getElementById('galleryPicker'); if(d&&typeof d.show==='function') d.show(); else d?.setAttribute('open','true'); } },
            closeGallery(){ const d=document.getElementById('galleryPicker'); if(d&&typeof d.hide==='function') d.hide(); else d?.removeAttribute('open'); },
            async loadGallery(){ try{ const r=await fetch('/prompt_manager/images/output?limit=50'); const data = await r.json(); const arr = Array.isArray(data) ? data : (Array.isArray(data.images) ? data.images : []); this.gallery = arr.map(x=>{ const path = x.path || x.image_path || x.filename || x.file || x; const url = x.url || `/prompt_manager/images/serve/${encodeURIComponent(path)}`; const thumb = x.thumbnail_url || url; const name = (typeof x==='string') ? x.split('/').pop() : (x.filename || x.name || path.split('/').pop()); return { path, url, thumb, name }; }); if(this.gallery.length===0) this.gallery=[{path:'',url:'',name:'(no images found)'}]; } catch{ this.gallery=[{path:'',url:'',name:'(stub)'}]; } },
            async loadFromGallery(g){ try{ if(!g||!g.url) return; const resp = await fetch(g.url); const buf = await resp.arrayBuffer(); this.thumb = g.thumb || g.url; await this.processBuffer(buf, g.name || 'image', undefined); this.closeGallery(); } catch{} },
          });
        };
      })();
    </script>
    <script>
      (function(){
        function parsePossibleParams(str){ const out={positive:'',negative:''}; if(!str) return out; const negIdx=str.toLowerCase().indexOf('negative prompt'); if(negIdx>=0){ out.positive=str.slice(0,negIdx).trim().replace(/^prompt[: ]*/i,'').trim(); out.negative=str.slice(negIdx).replace(/negative prompt[: ]*/i,'').split('\n')[0].trim(); } else { out.positive=str.trim(); } return out; }
        async function parsePngText(arrayBuffer){ const data=new DataView(arrayBuffer); const text={}; let pos=8; while(pos<data.byteLength){ const len=data.getUint32(pos); pos+=4; const type=String.fromCharCode(data.getUint8(pos),data.getUint8(pos+1),data.getUint8(pos+2),data.getUint8(pos+3)); pos+=4; const chunk=new Uint8Array(arrayBuffer,pos,len); pos+=len; pos+=4; if(type==='tEXt'){ const idx=chunk.indexOf(0); const key=new TextDecoder().decode(chunk.slice(0,idx)); const val=new TextDecoder().decode(chunk.slice(idx+1)); text[key]=val; } else if(type==='iTXt'){ let i=0; const readz=()=>{ const j=chunk.indexOf(0,i); const s=new TextDecoder().decode(chunk.slice(i,j)); i=j+1; return s; }; const keyword=readz(); const compFlag=chunk[i++]; const compMethod=chunk[i++]; readz(); readz(); const textBytes=chunk.slice(i); let val; if(compFlag===1){ try{ val=new TextDecoder().decode(pako.inflate(textBytes)); }catch{ val=''; } } else { val=new TextDecoder().decode(textBytes);} text[keyword]=val; } else if(type==='zTXt'){ let i=0; const j=chunk.indexOf(0,i); const keyword=new TextDecoder().decode(chunk.slice(0,j)); i=j+1; i++; const val=new TextDecoder().decode(pako.inflate(chunk.slice(i))); text[keyword]=val; } } return text; }
        function detectType(buf){ const b=new Uint8Array(buf); const isPNG = b[0]===0x89 && b[1]===0x50 && b[2]===0x4E && b[3]===0x47 && b[4]===0x0D && b[5]===0x0A && b[6]===0x1A && b[7]===0x0A; const isJPG = b[0]===0xFF && b[1]===0xD8; return isPNG ? 'image/png' : (isJPG ? 'image/jpeg' : 'application/octet-stream'); }
        function parseJpegEXIF(buf){ const view=new DataView(buf); let off=0; const len=view.byteLength; const res={}; if(len<4 || view.getUint16(0)!==0xFFD8) return res; off=2; while(off+4<=len){ if(view.getUint8(off)!==0xFF) break; const marker=view.getUint8(off+1); off+=2; if(marker===0xD9||marker===0xDA) break; const size=view.getUint16(off,false); const start=off+2; if(marker===0xE1 && start+6<=len){ const isExif = String.fromCharCode(view.getUint8(start),view.getUint8(start+1),view.getUint8(start+2),view.getUint8(start+3))==='Exif' && view.getUint8(start+4)===0 && view.getUint8(start+5)===0; if(isExif){ const tiff = start+6; if(tiff+8<=len){ const bom=view.getUint16(tiff,false); const little = bom===0x4949; const rd16=(p)=>view.getUint16(p,little); const rd32=(p)=>view.getUint32(p,little); const readIFD=(base, ptr)=>{ const out={}; if(ptr+2>len) return out; let n=rd16(ptr); let p=ptr+2; for(let i=0;i<n;i++){ if(p+12>len) break; const tag=rd16(p); const type=rd16(p+2); const count=rd32(p+4); const valOff=rd32(p+8); const typeSize = (type===1||type===2||type===7)?1:(type===3?2:(type===4||type===9?4:8)); const byteLen = count*typeSize; let vOff = (byteLen<=4)? (p+8) : (tiff+valOff); let val=''; try{ if(type===2){ const bytes = new Uint8Array(buf, vOff, Math.max(0, Math.min(byteLen, len-vOff))); val = new TextDecoder().decode(bytes).replace(/\0+$/,''); } else if(type===7){ const bytes = new Uint8Array(buf, vOff, Math.max(0, Math.min(byteLen, len-vOff))); if(bytes.length>=8){ const head = new TextDecoder().decode(bytes.slice(0,8)); if(head.startsWith('ASCII')) val = new TextDecoder().decode(bytes.slice(8)).replace(/\0+$/,''); else val = new TextDecoder().decode(bytes).replace(/\0+$/,''); } else val = new TextDecoder().decode(bytes).replace(/\0+$/,''); } }catch(e){ val=''; } if(tag===0x010E && val) out.ImageDescription = val; if(tag===0x9286 && val) out.UserComment = val; if(tag===0x8769){ const exifPtr = tiff + valOff; const ex = readIFD(base, exifPtr); Object.assign(out, ex); } p+=12; } return out; }; const ifd0 = tiff + rd32(tiff+4); Object.assign(res, readIFD(tiff, ifd0)); } } } return res; }
        const prev = window.pmMetaApp;
        window.pmMetaApp = function(){ const base = prev ? prev() : {}; return Object.assign(base, {
          gallery: [],
          async processBuffer(buf, name, type){ this.texts={positive:'',negative:''}; this.workflow=''; this.raw=''; if(!type||type==='application/octet-stream'){ type = detectType(buf); } if(type==='image/png'){ const t=await parsePngText(buf); this.raw=JSON.stringify(t,null,2); const params=t.parameters||t.Parameter||t.parametersTxt||''; const prompt=t.prompt||t.Prompt||''; const neg=t['negative_prompt']||t.Negative||''; const wflow=t.workflow||t.Workflow||t['sd-metadata']||''; if(wflow){ try{ this.workflow=JSON.stringify(JSON.parse(wflow),null,2);}catch{ this.workflow=String(wflow);} } if(params){ const p=parsePossibleParams(params); this.texts.positive=p.positive||prompt||''; this.texts.negative=p.negative||neg||''; } else { this.texts.positive=prompt||''; this.texts.negative=neg||''; } } else if(type==='image/jpeg'){ const ex=parseJpegEXIF(buf); this.raw=JSON.stringify(ex,null,2); const user = ex.UserComment || ex.ImageDescription || ''; const p=parsePossibleParams(String(user)); this.texts.positive=p.positive; this.texts.negative=p.negative; } else { this.raw='(unknown image format for metadata)'; } this.fileName=name; this.fileType=type; this.fileSize=buf.byteLength; return true; },
          async openGallery(){ try{ await this.loadGallery(); } finally { const d=document.getElementById('galleryPicker'); if(d&&typeof d.show==='function') d.show(); else d?.setAttribute('open','true'); } },
          closeGallery(){ const d=document.getElementById('galleryPicker'); if(d&&typeof d.hide==='function') d.hide(); else d?.removeAttribute('open'); },
          async loadGallery(){ try{ const r=await fetch('/prompt_manager/images/output?limit=50'); const data = await r.json(); const arr = Array.isArray(data) ? data : (Array.isArray(data.images) ? data.images : []); this.gallery = arr.map(x=>{ const path = x.path || x.image_path || x.filename || x.file || x; const url = x.url || `/prompt_manager/images/serve/${encodeURIComponent(path)}`; const thumb = x.thumbnail_url || url; const name = (typeof x==='string') ? x.split('/').pop() : (x.filename || x.name || path.split('/').pop()); return { path, url, thumb, name }; }); if(this.gallery.length===0) this.gallery=[{path:'',url:'',name:'(no images found)'}]; } catch{ this.gallery=[{path:'',url:'',name:'(stub)'}]; } },
          async loadFromGallery(g){ try{ if(!g||!g.url) return; const resp = await fetch(g.url); const buf = await resp.arrayBuffer(); this.thumb = g.thumb || g.url; await this.processBuffer(buf, g.name || 'image', undefined); this.closeGallery(); } catch{} },
        }); };
      })();
    </script>
        <!-- ViewerJS Library -->
        <script src="/prompt_manager/vendor/viewerjs/dist/viewer.min.js"></script>

        <!-- Core modules -->
        <script src="/prompt_manager/js/modules/core/events.js"></script>
        <script src="/prompt_manager/js/modules/core/sse.js"></script>

        <!-- SSE Indicators -->
        <script src="/prompt_manager/js/modules/components/status-indicator.js"></script>
        <script src="/prompt_manager/js/modules/components/progress-indicator.js"></script>
        <script src="/prompt_manager/js/modules/components/footer-status.js"></script>

        <!-- ViewerJS Modules -->
        <script src="/prompt_manager/js/modules/components/viewer-manager.js"></script>
        <script src="/prompt_manager/js/modules/components/filmstrip-manager.js"></script>
        <script src="/prompt_manager/js/modules/services/metadata-manager.js"></script>
        <script src="/prompt_manager/js/modules/core/viewer-integration.js"></script>

        <!-- Existing scripts -->
        <script src="/prompt_manager/js/notifications.js"></script>

        <!-- Initialize ViewerJS Integration for Metadata Page -->
        <script>
          document.addEventListener('DOMContentLoaded', function() {
            // Initialize realtime components
            if (window.FooterStatus) {
              FooterStatus.init({
                showText: true,
                showCount: true,
                enableTooltips: true
              });
            }

            if (window.StatusIndicator) {
              StatusIndicator.init({
                position: 'bottom-right',
                autoHide: true,
                autoHideDelay: 5000,
                showDetails: true
              });
            }

            if (window.ProgressIndicator) {
              ProgressIndicator.init({
                position: 'top-center',
                showPercentage: true,
                showTimeEstimate: true,
                stackable: true
              });
            }

            // Wait for Alpine to be ready
            setTimeout(function() {
              ViewerIntegration.init({
                viewer: {
                  theme: 'dark',
                  inline: true,
                  toolbar: false,
                  navbar: false
                },
                metadata: {
                  enabled: true,
                  position: 'bottom',
                  autoShow: true,
                  showExportButton: true
                }
              });
            }, 100);
          });
        </script>

<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <!-- Footer -->
    <footer class="main-footer">
      <div class="footer-content">
        <div class="footer-text">
          PromptManager â€” Clean, Fast, Local. Â© 2025
        </div>
        <div class="footer-links">
          <a href="#" class="footer-link">Documentation</a>
          <a href="#" class="footer-link">GitHub</a>
          <a href="#" class="footer-link">Support</a>
        </div>
      </div>
    </footer>
  </body>
  </html>
